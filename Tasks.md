# Задания по SQL
1. Написать запрос в таблицу PHONE_CATALOG, выводящий суммарную стоимость партии телефонов, у которых дата поставки в период 1-15 сентябре 2024, красного цвета *RED* или зеленого цвета *GREEN* и есть возможность купить его в рассрочку.
1. Написать запрос в таблицу PHONE_CATALOG, выводящий модель телефона с минимальной стоимостью первоначального платежа, который можно купить в рассрочку, есть выбор цвета, страна производства начинается на *C* и с датой поставки позже *15 марта 2024*.
1. Написать запрос в таблицы USAGE_DATA_HISTORY и USAGE_FILE_HISTORY, собирающий статистику по файлам за предыдущий день:
    * Число уникальных абонентов в этом файле.
    * Общее количество всех событий.
    * Общее количество звонков.
    * Общая длительность звонков в минутах.
    * Общее число SMS.
    * Общий объём всех интернет сессий в мегабайтах.
    * Сумма всех списаний без скидки.
    * Сумма всех списаний со скидкой.
1. Написать запрос в таблицу USAGE_DATA_HISTORY, возвращающий все события по абонентам за прошлый день, проранжированным по времени события для каждого абонента.
1. Написать запрос в таблицу USAGE_DATA_HISTORY, возвращающий все события по абонентам за прошлый день с вычислением доли стоимости каждого события в разрезе абонента.

## Дополнительная информация
Все таблицы хранятся в СУБД Oracle 19c.

### Описание таблицы PHONE_CATALOG
|Поле           |Описание                                                      				|
|---------------|---------------------------------------------------------------------------|
|PHONE_ID       |Уникальный идентификатор модели телефона 								    |
|PHONE_NAME     |Модель телефона                 											|
|COUNTRY        |Cтрана производства									      			    |
|DATE_DELIVERY  |Дата поставки телефона                  									|
|QUANTITY       |Количество телефонов в данной поставке 						            |
|PRICE          |Стоимость модели телефона в данной поставке                                |
|COLOR          |Цвет телефона                           								    |
|INSTALLMENT    |Маркер возможности покупки телефона в рассрочку (*Y*, если можно и *N* нет)|
|INITIAL_PAYMENT|Первоначальный платеж при покупке в рассрочку                              |

### Описание таблицы USAGE_DATA_HISTORY
|Поле           |Описание                                                       |
|---------------|---------------------------------------------------------------|
|PARTY_ID       |Уникальный номер основного абонента, которому выставляется счёт|
|OTHER_PARTY_ID |Уникальный номер второго абонента в событии                    |
|SERVICE_ID     |Идентификатор типа предоставляемой услуги                      |
|CALL_DATE      |Время соединения                                               |
|CALL_DURATION  |Длительность соединения в секундах                             |
|TOTAL_VOLUME   |Общий объём данных соединения в байтах                         |
|CHARGED_DATE   |Время выставления счёта                                        |
|CHARGE_AMOUNT  |Стоимость предоставляемой услуги                               |
|DISCOUNT_AMOUNT|Скидка по предоставляемой услуге                               |
|FILE_ID        |Уникальный номер файла для связи с таблицей USAGE_FILE_HISTORY |

### Описание таблицы USAGE_FILE_HISTORY
|Поле     |Описание               |
|---------|-----------------------|
|FILE_ID  |Уникальный номер файла |
|FILE_NAME|Уникальное имя файла   |
|FILE_DATE|Дата формирования файла|

### Словарь для Service ID:
|Ключ|Описание|
|----|--------|
|1   |Звонок  |
|2   |SMS     |
|3   |Интернет|


# Задания по PL/SQL
1. Написать процедуру, подсчитывающую количество таблиц, имена которых начинаются с DS% либо REF%. Вывести сообщение с полученными расчётами.
1. Написать процедуру, которая выполняет вставку данных в таблицу REF_TARIFF, а также записывает информацию об этой операции в таблицу OPERATION_LOG.

Описание таблицы REF_TARIFF
|Поле           |Описание                                  |
|---------------|------------------------------------------|
|RATE_PLAN_ID   |Уникальный идентификатор тарифного плана  |
|MONTHLY_FEE    |Абонентская плата за тарифный план в месяц|
|CALL_TARIFF    |Тариф за минуту звонка                    |
|SMS_TARIFF     |Тариф за одно SMS                         |
|INTERNET_TARIFF|Тариф за мегабайт интернет сессии         |
|TARIFF_DATE    |Дата установки тарифа                     |

Описание таблицы OPERATION_LOG
|Поле          |Описание                                                      |
|--------------|--------------------------------------------------------------|
|ID            |Уникальный идентификатор операции, проставляется автоматически|
|OPERATION_TYPE|Тип операции                                                  |
|TABLE_NAME    |Имя таблицы, которая задействована в операции                 |
|START_DATE    |Дата начала выполнения операции                               |
|END_DATE      |Дата завершения операции                                      |
|STATUS        |Текущий статус операции: P[Progress], D[Done], F[Failed]      |
|MESSAGE       |Текстовое сообщение, описывающее результат операции или ошибку|

Процедура должна:
1. Принимать в качестве аргументов значения для вставки: rate_plan_id, monthly_fee, call_tariff, sms_tariff, internet_tariff, tariff_date.
2. Добавлять запись в таблицу OPERATION_LOG в начале процедуры и обновлять её в конце всей необходимой информацией.
3. Выполнять вставку полученных в аргументах значений в таблицу REF_TARIFF.


# Задания по Python

## Работа с классами и интерфейсами в Python
Напишите концепт программы на Python с системой обработки данных.
Система должна включать интерфейсы разных типов данных с возможностью выгрузки и загрузки информации, а также модели для обработки этой информации и предоставления результатов этой обработки.
Интерфейсы и модели должны быть детально описаны с точки зрения параметров, передаваемых в конструкторы и методы.
В то же время, тело методов интерфейсов и моделей может быть пустым, то есть вместо конкретных алгоритмов содержать функцию ```print``` с сообщением о выполняемом действии.

### Требования:
1. Создайте базовый интерфейс BaseProcessor с методами extract_data и load_data.
1. Реализуйте два класса, которые наследуют этот интерфейс:
    1. CSVDataProcessor для выгрузки данных из CSV файлов.
    1. TableDataProcessor для загрузки данных в таблиц базу данных.
1. Создайте базовый класс BaseModel с методами process_data и save_result.
1. Переопределите этот класс для создания двух моделей:
    1. TestDataModel для тестирования данных и сохранения результатов тестов в базу данных.
    1. StatisticsDataModel для агрегации данных и сохранения статистики в базу данных.

Программа должна:
1. Загружать данные из CSV и возвращать их в виде специального объекта по вызову метода extract_data.
1. Передавать объект с данными в метод load_data для загрузки извлеченной информации в базу данных.
1. Выполнять тестирование данных и сохранять результат в базу данных.
1. Выполнять сбор статистики из данных и сохранять результат в базу данных.

## Обработка данных с помощью Python
Напишите программу на Python для обработки данных из CSV файла.
Программа должна читать данные из файла с логами звонков, выполнить требуемые трансформации с данными и соханить результат в новом CSV файле.

### Требования:
1. Программа должна считывать данные о соединениях из CSV-файла.
1. Данные исходного файла имеют формат partyMSISDN, partyIMSI, calledPartyNumber, callingPartyNumber, callDate, timeZoneOffset, callDuration, totalVolume, totalQuantity.
1. Данные целевого файла имеют формат party_msisdn, party_imsi, called_party_number, calling_party_number, call_date, call_duration, total_volume, total_quantity, call_type.

### Пример файла
Смотрите файл во вложении usage_data.log.

### Словарь для Call Type:
|Ключ|Описание        |
|----|----------------|
|1   |Исходящий звонок|
|2   |Входищий звонок |
|3   |Исходящая SMS   |
|4   |Входящая SMS    |
|5   |Интернет        |


Программа должна:
1. Прочитать данные из файла и преобразовать каждую запись в словарь.
1. Выполнить следующую обработку данных:
    1. Переименовать ключи каждой записи в соответствии с целевым форматом.
    1. Выполнить нормализацию телефонных номеров: убрать префиксы, очистить от пробелов и добавить международный код 375 для беларуских номеров.
    1. Перевести время соединений к местному часовому поясу в формате ISO YYYY-MM-DD HH24:MI:SS.
    1. Заполнить значение call_type на основе следующей логики:
        * Если в записи заполнена длительность, то событие является звонком.
        * Если в записи заполнен объём, то событие является интернет сессией.
        * Если в записи заполнено количество, то событие является SMS.
        * Если в записи заполнен номер, на который звонят, то событие является исходящим.
        * Если в записи заполнен номер, с которого звонят, то событие является входящим.
1. Записать полученные после обработки данные в новый текстовый файл, добавив в имя файла время его создания.
1. Вывести в терминале:
    1. Имя файла, общее количество найденных соединенний, время начала и завершения обработки.
    1. Общее количество и суммарную длительность звонков, объём интернет сессий и количество SMS.
    1. Количество ошибок при обработке данных.
